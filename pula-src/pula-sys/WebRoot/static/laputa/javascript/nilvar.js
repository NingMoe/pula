NilCalendar=function(){this.div=null;this.target=null;this.targets=new Array();this.init()};NilCalendar.prototype={init:function(){this.div=document.createElement("div");this.div.id="calendarDiv";$("calendarHere").appendChild(this.div);var a=function(d,b,e){var c=b[0];e.selectDate(c)};document.addEvent("click",this.clickDom);document.nilnutCalendar=this;this.cal=new YAHOO.widget.Calendar("cal","calendarDiv",{title:"请选取日期",close:true});this.cal.selectEvent.subscribe(a,this,true);this.applyCfg();this.cal.render()},clickDom:function(c){if(document.nilnutCalendar!=null){var a=new Event(c);var b=document.nilnutCalendar;if(!b.isInnerElement(a.target)){document.nilnutCalendar.hide()}}},isInnerElement:function(b){if(this.div.contains(b)){return true}var d=this.targets.length;for(var a=0;a<d;a++){if(this.targets[a]==b){return true}}},addTextBox:function(a){$(a).addEvent("focus",this.focusTextBox);$(a).addEvent("blur",this.blurTextBox);$(a).cal=this;this.targets.push($(a))},applyCfg:function(){this.cal.cfg.setProperty("MDY_YEAR_POSITION",1);this.cal.cfg.setProperty("MDY_MONTH_POSITION",2);this.cal.cfg.setProperty("MDY_DAY_POSITION",3);this.cal.cfg.setProperty("MY_YEAR_POSITION",1);this.cal.cfg.setProperty("MY_MONTH_POSITION",2);this.cal.cfg.setProperty("MONTHS_SHORT",["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"]);this.cal.cfg.setProperty("MONTHS_LONG",["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"]);this.cal.cfg.setProperty("WEEKDAYS_1CHAR",["\u65E5","一","二","三","四","五","六"]);this.cal.cfg.setProperty("WEEKDAYS_SHORT",["\u65E5","一","二","三","四","五","六"]);this.cal.cfg.setProperty("WEEKDAYS_MEDIUM",["\u65E5","一","二","三","四","五","六"]);this.cal.cfg.setProperty("WEEKDAYS_LONG",["\u65E5","一","二","三","四","五","六"]);this.cal.cfg.setProperty("MY_LABEL_YEAR_POSITION",1);this.cal.cfg.setProperty("MY_LABEL_MONTH_POSITION",2);this.cal.cfg.setProperty("MY_LABEL_YEAR_SUFFIX","\u5E74");this.cal.cfg.setProperty("MY_LABEL_MONTH_SUFFIX","")},hide:function(){this.div.style.display="none"},focusTextBox:function(a){this.cal.target=this;this.cal.initDate(this.value);var d=(this.cal.div);var b=$(this).getCoordinates();d.style.display="block";d.style.left=b.left;d.style.top=b.top+b.height},blurTextBox:function(a){},selectDate:function(e){e=e[0];if(this.target!=null){var b=e[0],c=e[1],a=e[2];this.target.value=b+"-"+c+"-"+a}this.target.fireEvent("change");this.hide()},initDate:function(h){if(!isDate(h)){return}var b=h.indexOf("-");var f=h.lastIndexOf("-");var e=h.substring(0,b);var g=h.substring(b+1,f);var a=h.substring(f+1);this.cal.select(e+"/"+g+"/"+a);var c=this.cal.getSelectedDates()[0];this.cal.cfg.setProperty("pagedate",c.getFullYear()+"/"+(c.getMonth()+1));this.cal.render()},check:function(){for(var a=0;a<this.targets.length;a++){var b=this.targets[a].value;if(!isEmpty(b)&&!isDate(b)){alert("请正确填写或选取日期，格式为:YYYY-MM-DD ；或者请留空白");this.targets[a].focus();return false}}return true}};function clickAll(d,c){var f=d;var a=$$(f);for(var e=0;e<a.length;e++){a[e].checked=c}}function checkSelected(b){var d=b;var a=$$(d);for(var c=0;c<a.length;c++){if(a[c].checked){return true}}alert("请至少选择一项");return false}function submitForm(a){if(window.ie){$(a).submit()}else{$(a+".submitBtn").click()}}function checkAll(a,d){var e=document.all[d];if(typeof(e)=="undefined"){return false}if(typeof(e.length)=="undefined"){e.checked=a}else{for(var c=0;c<e.length;c++){e[c].checked=a}}}function checkListSelected(a){for(var b=0;b<a.options.length;b++){if(a.options[b].selected){return true}}return false}function checkAllCss(a,d){var e=$$(d);if(typeof(e)=="undefined"){return false}if(typeof(e.length)=="undefined"){e.checked=a}else{for(var c=0;c<e.length;c++){e[c].checked=a}}}function checkSelectedCss(e){var f=$$(e);if(typeof(f)=="undefined"){return false}if(typeof(f.length)=="undefined"){return f.checked}else{var a=false;for(var c=0;c<f.length;c++){var d=(f[c].checked);a=d||a}return a}}function clearSelect(b){for(var a=0;a<b.options.length;){b.removeChild(b.options[a])}}function addSelectOption(c,b){for(var a=0;a<b.length;a++){c.options[c.options.length]=new Option(b[a].text,b[a].value)}}function makeSelectSelected(c,b){for(var a=0;a<c.options.length;a++){if(c.options[a].value==b){c.options[a].selected=true;break}}}NilShortcutEditor=function(a){this.config=a;if(!$defined(this.config.param)){this.config.param=""}this.init()};NilShortcutEditor.prototype={init:function(){var a=$(this.config.editor);a.shortcut=this;a.addEvent("keydown",this.onKeyDown);a=$(this.config.select);a.style.display="none";a.shortcut=this;a.addEvent("change",this.onChange);a.addEvent("keydown",this.onSelectKeyDown)},onSelectKeyDown:function(b){var a=new Event(b);if(a.key!="enter"){return}event.keyCode=9;return true},onChange:function(c){var a=(this.shortcut);var b=a.config.select.options[a.config.select.selectedIndex].itemObj;if(b){a.config.editor.value=b.no;a.config.container.innerHTML=b.name}},onKeyDown:function(f){var c=new Event(f);if(c.key!="enter"){return}c.stop();var b=(this.shortcut);var d=b.config.editor.value;b.config.container.innerHTML="";b.config.container.style.display="none";b.config.select.style.display="none";var g=b.config.select;var a=new XHR({method:"post"});a.addEvent("onSuccess",function(j){var i=Json.evaluate(j,true);if(i==null){alert("无效的JSON数据:"+j);return}if(i.error){alert(i.message)}else{if(i.list.length<=0){alert("没有找到指定的数据:"+d);b.config.editor.focus();b.config.editor.select();return}else{if(i.list.length==1){i=i.list[0];b.config.container.style.display="block";b.config.select.style.display="none";b.config.container.innerHTML=i.name;b.config.editor.value=i.no}else{b.config.container.style.display="none";b.config.select.style.display="block";g.options.length=0;g.options[0]=new Option("请选取...","");g.options[0].selected=true;g.options[0].style.color="blue";for(var k=0;k<i.list.length;k++){var h=i.list[k];g.options[k+1]=new Option(h.name,h.no);g.options[k+1].itemObj=h}g.focus()}}}});a.send(b.config.url,"jsonFormat=true&jsonSupport=true&no="+d+b.config.param)}};function goURL(a){a=trimMark(a);if(a.indexOf("?")>=0){a+="&mark="+getDateStr()}else{a+="?mark="+getDateStr()}location.href=a}function trimMark(a){var b=a.indexOf("?mark=");if(b>=0){return a.substring(0,b)}else{b=a.indexOf("&mark=");if(b>=0){return a.substring(0,b)}}return a}function appendMark(a){if(a.indexOf("?")>=0){a+="&mark="+getDateStr()}else{a+="?mark="+getDateStr()}return a}function getDateStr(){var b=new Date();var a=""+b.getYear()+""+b.getMonth()+""+b.getDay()+b.getHours()+b.getMinutes()+b.getSeconds();return a}function getDateStr1(){var b=new Date();var a=""+b.getYear()+""+b.getMonth()+""+b.getDay()+b.getHours()+b.getMinutes()+b.getSeconds()+b.getMilliseconds();return a}function goURL2(a,b){if(a.indexOf("?")>=0){a+="&mark="+getDateStr()}else{a+="?mark="+getDateStr()}b.location=a}function focusFirst(){document.forms[0].elements[0].focus()}function $F(a){if(!$defined($(a))){alert("not defined:"+a);return""}return $(a).value}function DateAdd(j,c,f){var l=new Date(j.replace("-",","));var k=1;var b=k*1000;var d=b*60;var e=d*60;var h=e*24;var g=h*365;var i;var a=new Date(l);var a=a.valueOf();switch(f){case"ms":i=new Date(a+k*c);break;case"s":i=new Date(a+b*c);break;case"mi":i=new Date(a+d*c);break;case"h":i=new Date(a+e*c);break;case"d":i=new Date(a+h*c);break;case"y":i=new Date(a+g*c);break;default:return escape("日期格式不对")}i=new Date(i);return i.getFullYear()+"-"+(i.getMonth()+1)+"-"+i.getDate()}if(window.Node){Node.prototype.contains=function(b){if(!b){return false}var d=b.tagName;var e=this.getElementsByTagName(d);var a=e.length;for(var c=0;c<a;c++){if(e[c]==b){return true}}return false}}function changeRow(b){var a="uncheckedRow";if(b.checked){a="checkedRow"}$("row"+b.value).className=a}function ToDBC(c){var d=c.value;var a="";for(var b=0;b<d.length;b++){if(d.charCodeAt(b)==12288){a+=String.fromCharCode(d.charCodeAt(b)-12256);continue}if(d.charCodeAt(b)>65280&&d.charCodeAt(b)<65375){a+=String.fromCharCode(d.charCodeAt(b)-65248)}else{a+=String.fromCharCode(d.charCodeAt(b))}}c.value=a}function copyToClipboard(b){if(window.clipboardData){window.clipboardData.clearData();window.clipboardData.setData("Text",b)}else{if(navigator.userAgent.indexOf("Opera")!=-1){window.location=b}else{if(window.netscape){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(g){alert("被浏览器拒绝！\n请在浏览器地址栏输入'about:config'并回车\n然后将'signed.applets.codebase_principal_support'设置为'true'")}var d=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!d){return}var c=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!c){return}c.addDataFlavor("text/unicode");var h=new Object();var a=new Object();var h=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);var i=b;h.data=i;c.setTransferData("text/unicode",h,i.length*2);var f=Components.interfaces.nsIClipboard;if(!d){return false}d.setData(c,null,f.kGlobalClipboard);alert("复制成功！")}}}}function renderTable(c){var a=$ES("tr",c);for(var b=0;b<a.length;b++){if(a[b].className=="title"){continue}if(b%2==0){a[b].className="evenRow"}else{a[b].className="oddRow"}}}function deleteParam(a,c){var d=a.indexOf("?"+c);var b="";if(d<0){d=a.indexOf("&"+c)}if(d<0){return a}b=a.substring(0,d);len=c.length+2;a=a.substring(d+len+1);d=a.indexOf("&");if(d<0){d=a.length}b=b+a.substring(d);return b}function addParam(b,d,a){var e=b.lastIndexOf("?");while(e==(b.length-1)){b=b.substring(0,e);e=b.lastIndexOf("?");c=true}var c=b.lastIndexOf("?")==-1;if(c){b+="?"}else{b+="&"}b+=d+"="+encodeURIComponent(a);return b}function deleteSharp(a){var b=a.indexOf("#");if(b<0){return a}return a.substring(0,b)}function betweenDays(a,g){a=a.replace(/-/g,"/");g=g.replace(/-/g,"/");var d=new Date(a);var c=new Date(g);var h=d.getTime()-c.getTime();var f=parseInt(h/(1000*60*60*24));return f}function isBetween(c,b,a){if(c<b){return false}if(c>a){return(false)}return(true)}function isBigDate(e,g){if((!isDate(e))||(!isDate(g))){return -1}var h=e.indexOf("-");var d=e.lastIndexOf("-");var a=e.substring(0,h);var f=e.substring(h+1,d);var j=e.substring(d+1,e.length);h=g.indexOf("-");d=g.lastIndexOf("-");var c=g.substring(0,h);var i=g.substring(h+1,d);var b=g.substring(d+1,g.length);if(a<c){return 0}if(f<i){return 0}if(j>b){return 1}return 0}function isDate(c){var b=c.indexOf("-");var f=c.lastIndexOf("-");if(b==f){return(false)}else{var h=c.substring(0,b);var a=c.substring(b+1,f);var g=c.substring(f+1,c.length);var e=31;if(isInt(a)==false||isInt(g)==false||isInt(h)==false){return false}else{if(h.length<4){return false}else{if(!isBetween(a,1,12)){return(false)}else{if(a==4||a==6||a==9||a==11){e=30}else{if(a==2){if(h%4>0){e=28}else{if(h%100==0&&h%400>0){e=28}else{e=29}}}}}}}if(isBetween(g,1,e)==false){return(false)}else{if(h<1900){return false}else{return(true)}}}}function isTime(a){var d=a.indexOf(":");if((d<1)||(d>2)){return(false)}else{var c=a.substring(0,d);var b=a.substring(d+1,a.length);if((c.length<1)||(c.length>2)||(!isInt(c))){return(false)}else{if((b.length<1)||(b.length>2)||(!isInt(b))){return(false)}else{if((!isBetween(c,0,23))||(!isBetween(b,0,59))){return(false)}else{return(true)}}}}}function isTimeHM(a){var d=a.indexOf(":");if((d<1)||(d>2)){return(false)}else{var c=a.substring(0,d);var b=a.substring(d+1,a.length);if((c.length<1)||(c.length>2)||(!isInt(c))){return(false)}else{if((b.length<1)||(b.length>2)||(!isInt(b))){return(false)}else{if((!isBetween(c,0,23))||(!isBetween(b,0,59))){return(false)}else{return(true)}}}}}function IsTimeOrEmpty(a){if(isEmpty(a)){return true}if(isTimeHM(a)){return true}return false}function isDigit(b){var a="0123456789";if(isEmpty(b)){return(false)}else{if(a.indexOf(b)==-1){return(false)}}return(true)}function isEmpty(a){if((a==null)||(a.length==0)){return true}if(a=="EMPTY-STRING"){return true}else{return(false)}}function isInt(b){var a=true;if(isEmpty(b)){a=false}else{for(var c=0;c<b.length;c++){if(isDigit(b.substring(c,c+1))==false){a=false;break}}}return(a)}function isInteger(b){var a=parseInt(b);if(isNaN(a)){return false}return true}function isUInt(theStr){return((isInt(theStr))&&(eval(theStr)>0))}function isNInt(theStr){return((isInt(theStr))&&(eval(theStr)>=0))}function isReal(a){var d=a.indexOf(".");var f=a.lastIndexOf(".");var c=true;if(isEmpty(a)){return false}if(d==-1){if(!isInt(a)){return(false)}else{return(true)}}else{if(d!=f){return(false)}else{if(d==0){return(false)}else{var b=a.substring(0,d);var e=a.substring(f+1);if(!isInt(b)||!isInt(e)){return(false)}else{if(isEmpty(e)){return(false)}else{return(true)}}}}}}function isUReal(a){if(!isReal(a)){return false}if(a<=0){return false}return true}function isNReal(a){if(!isReal(a)){return false}if(a<0){return false}return true}function isQuot(d){var c=d.length;var a,b;for(a=0;a<c;a++){b=d.substring(a,a+1);if(b=="'"||b=='"'){return true}}return false}function isDateTime(c){var d=c.indexOf(" ");if(d<0){return false}var b=c.substring(0,d);var a=c.substring(d+1);if(!(isDate(b)&&isTime(a))){return false}return true}function isEmail(a){var b=/^[_a-zA-Z0-9+\.]+@([\-_a-zA-Z0-9]+\.)+[A-Za-z0-9]{2,3}$/;if(b.test(a)){return true}return false}function isCharsInBag(b,d){var a,e;for(a=0;a<b.length;a++){e=b.charAt(a);if(d.indexOf(e)<=-1){return""}}return"find"}function isKeyStr(a){var b;var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_-.";b=isCharsInBag(a,c);if(b!=""){return true}return false}function goURL(a){a=trimMark(a);if(a.indexOf("?")>=0){a+="&mark="+getDateStr()}else{a+="?mark="+getDateStr()}location.href=a}function goMainFrameURL(a){if(a.indexOf("?")>=0){a+="&mark="+getDateStr()}else{a+="?mark="+getDateStr()}top.mainFrame.location.href=a}function goURL2(a,b){if(a.indexOf("?")>=0){a+="&mark="+getDateStr()}else{a+="?mark="+getDateStr()}b.location=a}function centerWindow(b,d,a){if(document.all){var h=screen.width,f=screen.height}else{if(document.layers){var h=window.outerWidth,f=window.outerHeight}else{var h=640,f=480}}var c=(h-d)/2,g=(f-a)/2;if(b.indexOf("?")>=0){b+="&mark="+getDateStr()}else{b+="?mark="+getDateStr()}var e=window.open(b,"","toolbar=0,resizable=1,scrollbars=1,dependent=0,width="+d+",height="+a+",screenX="+c+",screenY="+g+", top="+g+",left="+c+",statusbar=yes");e.focus();return e}function backWindow(a){if(a.indexOf("?")>=0){a+="&mark="+getDateStr()}else{a+="?mark="+getDateStr()}var b=window.open(a,"","toolbar=0,resizable=0,scrollbars=0,dependent=0,width=1,height=1,screenX=1,screenY=1, top=1,left=1,statusbar=no");b.opener.focus();return b}function queryString(c){var b=window.location.search;var a=b.toLowerCase();var f=a.indexOf(c+"=");if(f==-1){return null}var d=a.indexOf("&",f);var e=b.substring(f+c.length+1,(d==-1)?999:d);return e}function formatMoney(f){if(!isReal(f.value)){f.style.backgroundColor="pink";return}else{f.style.backgroundColor=""}var e=f.value*1;var d=e;var c=parseInt(e);if(isNaN(c)){d=e}else{if(c==e){d=c+".00"}else{c=parseInt(e*100);if(isNaN(c)){}else{if(c!=e*100){d=c/100}}}}var b=""+e;var a=b.indexOf(".");if(a>=0&&b.length-a<3){d=e+"0"}if(d==0){d="0.00"}f.value=d}function getMoney(a){return(Math.round(a*100)/100)}function isEmptyURL(a){if(isEmpty(a)){return true}if(a=="about:blank"||a=="welecome.action"){return true}return false}function goEmail(a){goURL("mailto:"+a)}function goURL3(b,a){var b=b.replace("http://http://","http://");if(a=="_blank"){window.open(b)}else{goURL2(b,a)}}function isFilePath(b){var a=/^(\\|(\w{1}:))/;if(a.test(b)){return true}return false}function isHour(h){if(!isUInt(h)){return false}var ih=eval(h);if(ih<0||ih>=24){return false}return true}function isMinute(m){if(!isUInt(m)){return false}var ih=eval(m);if(ih<0||ih>=60){return false}return true}function isMoney(a){var a=Math.abs(a);return(/^([0-9]\d+|[0-9])(\.\d\d?)*$/.test(a))}function isEmptyURL(a){if(isEmpty(a)){return true}if(a=="about:blank"||a=="welecome.action"){return true}return false}function isYear(n){if(!isInt(n)){return false}var y=eval(n);return true}function formatNumberObj(c){var a=c.value;var b=formatNumberNut(a,"0.00");if(isNaN(b)){c.value="0.00"}else{c.value=b}}function formatNumberNut(g,k){var l=g.toString();var o;var e;var d;var m;if(/\./g.test(k)){d=k.split(".")[0];m=k.split(".")[1]}else{d=k;m=null}if(/\./g.test(l)){if(m!=null){var h=Math.round(parseFloat("0."+l.split(".")[1])*Math.pow(10,m.length))/Math.pow(10,m.length);o=(Math.floor(g)+Math.floor(h)).toString();e=/\./g.test(h.toString())?h.toString().split(".")[1]:"0"}else{o=Math.round(g).toString();e="0"}}else{o=l;e="0"}if(d!=null){var i="";var j=d.match(/0*$/)[0].length;var n=null;if(/,/g.test(d)){n=d.match(/,[^,]*/)[0].length-1}var a=new RegExp("(\\d{"+n+"})","g");if(o.length<j){i=new Array(j+1).join("0")+o;i=i.substr(i.length-j,j)}else{i=o}var i=i.substr(0,i.length%n)+i.substring(i.length%n).replace(a,(n!=null?",":"")+"$1");i=i.replace(/^,/,"");o=i}if(m!=null){var b="";var j=m.match(/^0*/)[0].length;if(e.length<j){b=e+new Array(j+1).join("0");var f=b.substring(0,j);var c=b.substring(j,m.length);b=f+c.replace(/0*$/,"")}else{b=e.substring(0,m.length)}e=b}else{if(k!=""||(k==""&&e=="0")){e=""}}return o+(e==""?"":"."+e)};